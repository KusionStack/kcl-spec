<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# kcl

```go
import "gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
```

Package kcl defines the top\-level interface for the Kusion Configuration Language \(KCL\)\.

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	const k_code = `
import kcl_plugin.hello

name = "kcl"
age = 1

two = hello.add(1, 1)

schema Person:
    name: str = "kcl"
    age: int = 1

x0 = Person {}
x1 = Person {
	age = 101
}
`

	yaml := kcl.MustRun("testdata/main.k", kcl.WithCode(k_code)).First().YAMLString()
	fmt.Println(yaml)

	fmt.Println("----")

	result := kcl.MustRun("./testdata/main.k").First()
	fmt.Println(result.JSONString())

	fmt.Println("----")
	fmt.Println("x0.name:", result.Get("x0.name"))
	fmt.Println("x1.age:", result.Get("x1.age"))

	fmt.Println("----")

	var person struct {
		Name string
		Age  int
	}
	fmt.Printf("person: %+v\n", result.Get("x1", &person))
}
```

</p>
</details>

## Index

- [func FormatCode(code interface{}) ([]byte, error)](<#func-formatcode>)
- [func FormatPath(path string) (changedPaths []string, err error)](<#func-formatpath>)
- [func InitKclvmRuntime(n int)](<#func-initkclvmruntime>)
- [func LintPath(path string) (results []string, err error)](<#func-lintpath>)
- [func ListDepFiles(workDir string, opt *ListDepFilesOption) (files []string, err error)](<#func-listdepfiles>)
- [func OverrideFile(file string, specs, importPaths []string) (bool, error)](<#func-overridefile>)
- [func ValidateCode(data, code string, opt *ValidateOptions) (ok bool, err error)](<#func-validatecode>)
- [type KCLResult](<#type-kclresult>)
  - [func EvalCode(code string) (*KCLResult, error)](<#func-evalcode>)
- [type KCLResultList](<#type-kclresultlist>)
  - [func MustRun(path string, opts ...Option) *KCLResultList](<#func-mustrun>)
  - [func Run(path string, opts ...Option) (*KCLResultList, error)](<#func-run>)
  - [func RunFiles(paths []string, opts ...Option) (*KCLResultList, error)](<#func-runfiles>)
- [type KclType](<#type-kcltype>)
  - [func GetSchemaType(file, code, schemaName string) ([]*KclType, error)](<#func-getschematype>)
- [type ListDepFilesOption](<#type-listdepfilesoption>)
- [type Option](<#type-option>)
  - [func WithCode(codes ...string) Option](<#func-withcode>)
  - [func WithDisableNone(disableNone bool) Option](<#func-withdisablenone>)
  - [func WithIncludeSchemaTypePath(includeSchemaTypePath bool) Option](<#func-withincludeschematypepath>)
  - [func WithKFilenames(filenames ...string) Option](<#func-withkfilenames>)
  - [func WithOptions(key_value_list ...string) Option](<#func-withoptions>)
  - [func WithOverrides(override_list ...string) Option](<#func-withoverrides>)
  - [func WithPrintOverridesAST(printOverridesAST bool) Option](<#func-withprintoverridesast>)
  - [func WithSettings(filename string) Option](<#func-withsettings>)
  - [func WithSortKeys(sortKeys bool) Option](<#func-withsortkeys>)
  - [func WithWorkDir(workDir string) Option](<#func-withworkdir>)
- [type ValidateOptions](<#type-validateoptions>)


## func [FormatCode](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L83>)

```go
func FormatCode(code interface{}) ([]byte, error)
```

FormatCode returns the formatted code\.

## func [FormatPath](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L95>)

```go
func FormatPath(path string) (changedPaths []string, err error)
```

FormatPath formats files from the given path path: if path is \`\.\` or empty string\, all KCL files in current directory will be formatted\, not recursively if path is \`path/file\.k\`\, the specified KCL file will be formatted if path is \`path/to/dir\`\, all KCL files in the specified dir will be formatted\, not recursively if path is \`path/to/dir/\.\.\.\`\, all KCL files in the specified dir will be formatted recursively

the returned changedPaths are the changed file paths \(relative path\)

## func [InitKclvmRuntime](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L27>)

```go
func InitKclvmRuntime(n int)
```

InitKclvmRuntime init kclvm process\.

## func [LintPath](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L105>)

```go
func LintPath(path string) (results []string, err error)
```

LintPath lint files from the given path

## func [ListDepFiles](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L100>)

```go
func ListDepFiles(workDir string, opt *ListDepFilesOption) (files []string, err error)
```

ListDepFiles return the depend files from the given path

## func [OverrideFile](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L115>)

```go
func OverrideFile(file string, specs, importPaths []string) (bool, error)
```

OverrideFile rewrites a file with override spec file: string\. The File that need to be overridden specs: \[\]string\. List of specs that need to be overridden\. Each spec string satisfies the form: \<pkgpath\>:\<field\_path\>=\<filed\_value\> or \<pkgpath\>:\<field\_path\>\- When the pkgpath is '\_\_main\_\_'\, it can be omitted\. importPaths\. List of import statements that need to be added

## func [ValidateCode](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L120>)

```go
func ValidateCode(data, code string, opt *ValidateOptions) (ok bool, err error)
```

ValidateCode validate data match code

## type [KCLResult](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L20>)

```go
type KCLResult = kcl.KCLResult
```

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	const k_code = `
import kcl_plugin.hello

name = "kcl"
age = 1
	
two = hello.add(1, 1)
	
schema Person:
    name: str = "kcl"
    age: int = 1

x0 = Person {name = "kcl-go"}
x1 = Person {age = 101}
`

	result := kcl.MustRun("testdata/main.k", kcl.WithCode(k_code)).First()

	fmt.Println("x0.name:", result.Get("x0.name"))
	fmt.Println("x1.age:", result.Get("x1.age"))

}
```

#### Output

```
x0.name: kcl-go
x1.age: 101
```

</p>
</details>

<details><summary>Example ('et_struct)</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	const k_code = `
schema Person:
    name: str = "kcl"
    age: int = 1
    X: int = 2

x = {
    "a": Person {age = 101}
    "b": 123
}
`

	result := kcl.MustRun("testdata/main.k", kcl.WithCode(k_code)).First()

	var person struct {
		Name string
		Age  int
	}
	fmt.Printf("person: %+v\n", result.Get("x.a", &person))
	fmt.Printf("person: %+v\n", person)

}
```

#### Output

```
person: &{Name:kcl Age:101}
person: {Name:kcl Age:101}
```

</p>
</details>

### func [EvalCode](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L124>)

```go
func EvalCode(code string) (*KCLResult, error)
```

## type [KCLResultList](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L21>)

```go
type KCLResultList = kcl.KCLResultList
```

### func [MustRun](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L32>)

```go
func MustRun(path string, opts ...Option) *KCLResultList
```

MustRun is like Run but panics if return any error\.

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	yaml := kcl.MustRun("testdata/main.k", kcl.WithCode(`name = "kcl"`)).First().YAMLString()
	fmt.Println(yaml)

}
```

#### Output

```
name: kcl
```

</p>
</details>

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	const code = `
b = 1
a = 2
`
	yaml := kcl.MustRun("testdata/main.k", kcl.WithCode(code)).GetRawYamlResult()
	fmt.Println(yaml)

	yaml_sorted := kcl.MustRun("testdata/main.k", kcl.WithCode(code), kcl.WithSortKeys(true)).GetRawYamlResult()
	fmt.Println(yaml_sorted)

}
```

#### Output

```
b: 1
a: 2

a: 2
b: 1
```

</p>
</details>

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	const code = `
schema Person:
	name: str = ""

x = Person()
`
	json := kcl.MustRun("testdata/main.k", kcl.WithCode(code)).First().JSONString()
	fmt.Println(json)

	json_with_type := kcl.MustRun("testdata/main.k", kcl.WithCode(code), kcl.WithIncludeSchemaTypePath(true)).First().JSONString()
	fmt.Println(json_with_type)

}
```

#### Output

```
{
    "x": {
        "name": ""
    }
}
{
    "x": {
        "@type": "Person",
        "name": ""
    }
}
```

</p>
</details>

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	yaml := kcl.MustRun("./testdata/app0/kcl.yaml").First().YAMLString()
	fmt.Println(yaml)
}
```

</p>
</details>

### func [Run](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L37>)

```go
func Run(path string, opts ...Option) (*KCLResultList, error)
```

Run evaluates the KCL program with path and opts\, then returns the object list\.

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
	"log"
)

func assert(v bool, a ...interface{}) {
	if !v {
		a = append([]interface{}{"assert failed"}, a...)
		log.Panic(a...)
	}
}

func main() {
	// 根据 kcl.yaml 指定参数 运行
	x, err := kcl.Run("./testdata/app0/kcl.yaml")
	assert(err == nil, err)

	// 输出 deploy_topology[1].zone
	fmt.Println(x.First().Get("deploy_topology.1.zone"))

}
```

#### Output

```
RZ24A
```

</p>
</details>

### func [RunFiles](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L42>)

```go
func RunFiles(paths []string, opts ...Option) (*KCLResultList, error)
```

RunFiles evaluates the KCL program with multi file path and opts\, then returns the object list\.

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"gitlab.alipay-inc.com/ant-cas/KCLVM/kclvm-go/api/kcl"
)

func main() {
	result, _ := kcl.RunFiles([]string{"./testdata/app0/kcl.yaml"})
	fmt.Println(result.First().YAMLString())
}
```

</p>
</details>

## type [KclType](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L23>)

```go
type KclType = kcl.KclType
```

### func [GetSchemaType](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L136>)

```go
func GetSchemaType(file, code, schemaName string) ([]*KclType, error)
```

GetSchemaType returns schema types from a kcl file or code\.

file: string The kcl filename code: string The kcl code string schema\_name: string The schema name got\, when the schema name is empty\, all schemas are returned\.

## type [ListDepFilesOption](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L18>)

```go
type ListDepFilesOption = list.Option
```

## type [Option](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L17>)

```go
type Option = kcl.Option
```

### func [WithCode](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L47>)

```go
func WithCode(codes ...string) Option
```

WithCode returns a Option which hold a kcl source code list\.

### func [WithDisableNone](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L65>)

```go
func WithDisableNone(disableNone bool) Option
```

WithDisableNone returns a Option which hold a disable none switch\.

### func [WithIncludeSchemaTypePath](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L78>)

```go
func WithIncludeSchemaTypePath(includeSchemaTypePath bool) Option
```

WithIncludeSchemaTypePath returns a Option which hold a includeSchemaTypePath switch\.

### func [WithKFilenames](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L50>)

```go
func WithKFilenames(filenames ...string) Option
```

WithKFilenames returns a Option which hold a filenames list\.

### func [WithOptions](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L53>)

```go
func WithOptions(key_value_list ...string) Option
```

WithOptions returns a Option which hold a key=value pair list for option function\.

### func [WithOverrides](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L56>)

```go
func WithOverrides(override_list ...string) Option
```

WithOverrides returns a Option which hold a override list\.

### func [WithPrintOverridesAST](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L68>)

```go
func WithPrintOverridesAST(printOverridesAST bool) Option
```

WithPrintOverridesAST returns a Option which hold a printOverridesAST switch\.

### func [WithSettings](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L59>)

```go
func WithSettings(filename string) Option
```

WithSettings returns a Option which hold a settings file\.

### func [WithSortKeys](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L73>)

```go
func WithSortKeys(sortKeys bool) Option
```

WithSortKeys returns a Option which hold a sortKeys switch\.

### func [WithWorkDir](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L62>)

```go
func WithWorkDir(workDir string) Option
```

WithWorkDir returns a Option which hold a work dir\.

## type [ValidateOptions](<https://code.alipay.com/ant-cas/KCLVM/blob/master/kclvm-go/api/kcl/api.go#L19>)

```go
type ValidateOptions = validate.ValidateOptions
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
